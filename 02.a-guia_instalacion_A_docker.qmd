# Gu√≠a de Instalaci√≥n. Opci√≥n A: Instalaci√≥n v√≠a Paquete Preconfigurado (Docker)

## 1. Introducci√≥n al Entorno de Trabajo

Esta gu√≠a establece un entorno de **Reproducibilidad Cient√≠fica**. Utilizaremos una arquitectura h√≠brida: **VSCode** como editor local y **Docker** como laboratorio de ejecuci√≥n. Esta aproximaci√≥n garantiza que todos los estudiantes operen bajo las mismas versiones de motores geoespaciales (**GDAL, GEOS, PROJ**), eliminando el problema de "en mi computador no funciona".

El paquete que utilizaremos ya contiene preinstalado:
1. **Motores de an√°lisis**: Python, R y Julia con librer√≠as geoespaciales.
2. **Reportes**: Quarto y TinyTeX (LaTeX).
3. **Base de datos**: PostGIS (PostgreSQL con extensiones espaciales).

---

## 2. Preparaci√≥n de Herramientas en Windows (Host)

Antes de manipular el paquete del curso, instale las siguientes herramientas b√°sicas:

1.  **VSCode IDE**: Interfaz principal para editar archivos `.qmd` y gestionar c√≥digo.
2.  **Docker Desktop**: Motor de virtualizaci√≥n. Durante la instalaci√≥n, aseg√∫rese de activar la opci√≥n **"Use WSL 2 instead of Hyper-V"**.

### ‚ö†Ô∏è Optimizaci√≥n Cr√≠tica de Memoria (WSL2)
Los procesos de Sistemas de Informaci√≥n Geogr√°fica (SIG) consumen mucha RAM. Para evitar que Docker se cierre, configure los l√≠mites de memoria de Linux:
1.  Presione `Win + R`, escriba `%USERPROFILE%` y acepte.
2.  Busque o cree un archivo llamado `.wslconfig` (aseg√∫rese de que no tenga extensi√≥n `.txt`).
3.  Pegue el siguiente contenido y guarde:

```ini
[wsl2]
memory=12GB # RAM m√°xima f√≠sica asignada al laboratorio
swap=32GB   # Memoria de intercambio para procesos pesados
```
*Reinicie Docker Desktop despu√©s de este cambio.*

---

## 3. Despliegue del Laboratorio SIG

Siga estos pasos para instalar el entorno a partir del archivo `sig_unal_completo.zip`:

### Paso A: Preparaci√≥n de la Carpeta
1.  Cree una carpeta en su disco local con su ID institucional (ej. `D:\SIG_UNAL_2025\juperez`).
2.  Extraiga el contenido del archivo `sig_unal_completo.zip` en esa carpeta.
3.  Verifique que existan los siguientes archivos:
    * `sig_unal_completo.tar` (La imagen del sistema).
    * `docker-compose.yml` (El manifiesto de configuraci√≥n).

### Paso B: Carga de la Imagen en Docker
Abra una terminal de **PowerShell** dentro de la carpeta donde extrajo los archivos y ejecute:

```powershell
docker load -i sig_unal_completo.tar
```
*Este proceso puede tardar unos minutos. Verifique que al finalizar aparezca el mensaje "Loaded image" para `image_sig_unal:final` y `postgis_unal:final`.*

### Paso C: Lanzamiento del Laboratorio
En la misma terminal, ejecute:

```powershell
docker compose up -d
```
*Esto activar√° los dos contenedores: uno para an√°lisis geoespacial y otro para la base de datos.*

---

## 4. Acceso y Uso del Entorno

### üìì JupyterLab (An√°lisis Pol√≠glota)
Abra su navegador y acceda a: [http://localhost:8889](http://localhost:8889)
* **Contrase√±a/Token:** (Si se solicita) `geomatica2025`
* **Persistencia:** Todo archivo guardado en la carpeta `/home/rstudio/work` aparecer√° autom√°ticamente en su carpeta de Windows. **No guarde nada fuera de esa ruta**, o se perder√° al cerrar el contenedor.

### üêò Base de Datos PostGIS
Para conectar herramientas como QGIS o DBeaver, use los siguientes par√°metros:
* **Host:** `localhost`
* **Puerto:** `5434`
* **Usuario:** `profe_unal`
* **Contrase√±a:** `geomatica2025`
* **Base de Datos:** `sig_db_unal`

---

## 5. Verificaci√≥n de la Instalaci√≥n

Para confirmar que la "cirug√≠a" de librer√≠as y la conectividad son correctas, cree un nuevo Notebook de Julia en JupyterLab y ejecute el siguiente bloque:

```julia
# Validaci√≥n de Motores SIG y Conectividad
using LibPQ, LibGEOS, ArchGDAL, Plots

# 1. Prueba de conexi√≥n a PostGIS
try
    conn = LibPQ.Connection("host=db-postgis dbname=sig_db_unal user=profe_unal password=geomatica2025")
    println("‚úÖ Conexi√≥n a PostGIS: Exitosa")
    close(conn)
catch e
    println("‚ùå Error de conexi√≥n: ", e)
end

# 2. Prueba de Motores Geom√©tricos (GEOS)
try
    punto = LibGEOS.readgeom("POINT (0 0)")
    buffer_geom = LibGEOS.buffer(punto, 1.0)
    println("‚úÖ Motores geom√©tricos operativos (GEOS)")
    
    # Visualizaci√≥n del Buffer
    plt = plot(buffer_geom, title="Validaci√≥n SIG: Buffer GEOS", 
               fillcolor=:blue, fillalpha=0.3, aspect_ratio=:equal)
    display(plt)
catch e
    println("‚ùå Error en motores geom√©tricos o gr√°ficos: ", e)
end
```

---

## 6. Mantenimiento y Apagado

* Para **apagar** el laboratorio sin borrar datos: `docker compose stop`.
* Para **reiniciar** el laboratorio: `docker compose start`.
* Si necesita **borrar todo** para reinstalar (los datos de la DB se mantienen en el volumen): `docker compose down`.