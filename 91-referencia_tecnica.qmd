# Referencia T√©cnica y Compendio de Comandos {#anexo-referencia}

## Introducci√≥n a la Infraestructura de Datos

Este anexo constituye la gu√≠a t√©cnico para la gesti√≥n del entorno de desarrollo. A diferencia de los cap√≠tulos te√≥ricos, aqu√≠ nos centramos en la operatividad: c√≥mo configurar el motor de Docker, c√≥mo asegurar que la memoria virtual (Swap) no colapse en procesos masivos, c√≥mo sincronizar el conocimiento mediante Git, y otros temas t√©cnicos (ej. comandos) importantes.

---

## Contenedores Instalados

### Resumen de Infraestructura Docker {#sec-resumen-infra}

Antes de entrar en los detalles t√©cnicos, es vital entender el rol de los dos archivos maestros que sostienen su laboratorio geogr√°fico. 

| Archivo | Rol Cr√≠tico |
|:---|:--- |
| **`Dockerfile`** | **El "Qu√©" (La Receta):** Crea el entorno pol√≠glota desde cero, instala las librer√≠as de NASA/Copernicus y aplica la **"cirug√≠a" de OpenSSL** para que Julia sea estable en Ubuntu Noble. |
| **`docker-compose.yml`** | **El "C√≥mo" (La Orquesta):** Despliega los servicios, mapea los puertos externos (**8889**, **8788**, **5434**) y asegura que sus mapas y bases de datos no se borren gracias al volumen persistente (`postgis_data_unal`). |


::: {.callout-important}
### Persistencia de Datos
Gracias al `docker-compose`, si su contenedor se apaga o se reinicia, los datos de su base de datos PostGIS **no se pierden**. El volumen nombrado act√∫a como un disco duro externo que sobrevive a cualquier ca√≠da del sistema.
:::

### üß™ Bater√≠a de Pruebas de Integridad del Docker (Health Checks)

| ID | Comando de Verificaci√≥n (Docker) | Descripci√≥n |
|:---|:---|:---|
| 01 | `docker exec contenedor_sig_unal gdalinfo --version` | Verifica que el n√∫cleo de GDAL est√° activo. |
| 02 | `docker exec contenedor_sig_unal R -e "library(sf); st_point(c(0,0))"` | Prueba la librer√≠a `sf` y el motor de geometr√≠a en R. |
| 03 | `docker exec contenedor_sig_unal python3 -c "import geopandas; print(geopandas.__version__)"` | Verifica el stack espacial de Python. |
| 04 | `docker exec contenedor_sig_unal R -e "j_eval('sum([1, 2, 3])')"` | **Test Cr√≠tico:** Verifica la funci√≥n personalizada y el puente R -> Julia. |
| 05 | `docker exec contenedor_sig_unal R -e "j_plot('plot(rand(10))')"` | Prueba la generaci√≥n de gr√°ficos Julia capturados por R. |
| 06 | `docker exec contenedor_sig_unal julia -e 'using ArchGDAL; println(ArchGDAL.GDAL.gdalversioninfo("RELEASE_NAME"))'` | **Cirug√≠a Exitosa:** Confirma que Julia accede a GDAL del sistema (v3.12.1). |
| 07 | `docker exec contenedor_sig_unal R -e "library(RPostgres); dbConnect(Postgres(), host='db-postgis', dbname='sig_db_unal', user='profe_unal', password='geomatica2025')"` | Prueba la conexi√≥n R -> PostGIS (Interna). |
| 08 | `docker exec contenedor_sig_unal python3 -c "import psycopg2; conn = psycopg2.connect(host='db-postgis', dbname='sig_db_unal', user='profe_unal', password='geomatica2025'); print('Python PostGIS conectado ‚úÖ'); conn.close()"` | Prueba la conexi√≥n Python -> PostGIS (Interna). |
| 09 | `docker exec contenedor_sig_unal R -e "cat(whitebox::wbt_version())"` | Verifica que los binarios de WhiteboxTools est√°n instalados y accesibles. |
| 10 | `docker exec contenedor_sig_unal R -e "library(httpgd); print('Visor OK')"` | Verifica que el motor gr√°fico para VS Code est√° listo en el puerto `8787`. |

### Configuraci√≥n de Puertos y Conectividad {#sec-puertos}

Para que su computadora (Host) pueda comunicarse con los servicios dentro del contenedor, hemos dise√±ado un sistema de "puentes" o mapeo de puertos. Esto evita conflictos si ya tiene instalados otros servidores de bases de datos o Jupyter en su PC.

| Servicio | Puerto en su PC (Host) | Puerto en Contenedor | Prop√≥sito | Acceso / Conexi√≥n |
|:---|:---:|:---:|:---|:---|
| **Jupyter Lab** | `8889` | `8888` | Programaci√≥n y Notebooks | `http://localhost:8889` |
| **Visor R (httpgd)** | `8788` | `8787` | Gr√°ficos de R y VS Code | `http://localhost:8788` |
| **PostGIS (DB)** | `5434` | `5432` | Base de Datos Espacial | `localhost:5434` |

---

### üîë Credenciales de la Base de Datos {#sec-credenciales}

Utilice estos datos para configurar sus conexiones en QGIS, DBeaver o mediante c√≥digo (R/Python/Julia):

* **Base de Datos:** `sig_db_unal`
* **Usuario:** `profe_unal`
* **Contrase√±a:** `geomatica2025`
* **Host Interno:** `db-postgis` (Use este nombre √∫nicamente para conexiones **dentro** de sus scripts).



---

### L√≥gica de Arquitectura (Dockerfile y Compose) {#sec-arquitectura-puertos}

La configuraci√≥n del entorno se ha "blindado" t√©cnicamente para garantizar la estabilidad:

1.  **En el Dockerfile**: Se usan las instrucciones `EXPOSE 8888` y `EXPOSE 8787`. Esto le avisa a Docker que el contenedor tiene dos "puertas" abiertas internamente. Al fijar `httpgd.port = 8787`, nos aseguramos de que el visor de gr√°ficos de R no pelee con Jupyter por el mismo canal.
2.  **En el Docker-Compose**: 
    * **`8889:8888`**: Permite que este curso conviva con otras instalaciones de Jupyter (que suelen usar el 8888).
    * **`8788:8787`**: Habilita la conexi√≥n independiente de VS Code al visor de gr√°ficos de R.
    * **`5434:5432`**: Evita el choque con bases de datos locales (Postgres suele usar el 5432 o 5433).

---

### Gu√≠a de Acceso: El concepto de "Lados" {#sec-guia-acceso}

Es fundamental entender desde d√≥nde est√° intentando conectar:

> #### üåê Desde afuera (Su PC / Host)
> Es lo que usted configura en su navegador o en QGIS. Usted ve los puertos mapeados:
> * **Jupyter/Notebooks**: `http://localhost:8889` (usando el token `geomatica2025`).
> * **Base de Datos (QGIS/DBeaver)**: Host: `localhost`, Puerto: `5434`.

> #### üê≥ Desde adentro (El Contenedor)
> Sus scripts de Python, R y Julia no saben que existe un mapeo externo. Dentro de su "casa" Docker, nada ha cambiado:
> * **PostGIS**: El c√≥digo debe buscar el puerto est√°ndar `5432` y el host `db-postgis`.
> * **httpgd**: El servidor de gr√°ficos sigue escuchando en el puerto interno `8787`.

::: {.callout-note}
### Tip de Conexi√≥n
Si intenta conectar QGIS usando el puerto `5432` y falla, recuerde que el "puente" hacia el contenedor se construy√≥ espec√≠ficamente sobre el puerto **`5434`**.
:::


## Quarto: Orquestaci√≥n y Configuraci√≥n {#quarto-ref}

Quarto se basa en un archivo de configuraci√≥n centralizado donde se definen los par√°metros de renderizado, bibliograf√≠a y estilos.

### Opciones del encabezado yml

**Ejemplo 1**: Solo HTML

```markdown
---
title: "T√≠tulo de la Pr√°ctica"
author: "Nombre del Estudiante"
date: last-modified
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: left
    number-sections: true
    theme: lux
---
```

**Ejemplo 2**: HTML y Python

```markdown
---
title: "Informe T√©cnico: An√°lisis Geoespacial"
author: "ID Correo UNAL"
date: today
format:
  html:
    toc: true
    number-sections: true
    theme: cosmo
  pdf:
    toc: true
    toc-title: "Contenido"
    number-sections: true
    documentclass: scrreprt
    geometry:
      - top=25mm
      - left=25mm
      - right=25mm
      - bottom=25mm
---
```
### Resumen de comandos Quarto

`quarto render guia_instalacion.qmd --to all`

`quarto render guia_instalacion.qmd --to html`

`quarto render guia_instalacion.qmd --to pdf`

### Control de Ejecuci√≥n en Quarto: Opciones de Chunks {#sec-opciones-chunks}

Para que sus informes t√©cnicos sean profesionales, no basta con que el c√≥digo funcione; es necesario controlar qu√© se muestra y qu√© se oculta al lector final. En Quarto, esto se logra mediante el uso de "opciones de chunk" utilizando la sintaxis de la tuber√≠a de comentarios (`#|`).

| Opci√≥n de Chunk | ¬øSe ejecuta? | ¬øMuestra el C√≥digo? | ¬øMuestra Resultados / Plots? | Uso Ideal |
|:--- |:---:|:---:|:---:|:--- |
| **`#| echo: false`** | ‚úÖ S√ç | ‚ùå NO | ‚úÖ S√ç | **Para Resultados Finales.** Muestra el mapa/tabla sin la "receta". |
| **`#| include: false`** | ‚úÖ S√ç | ‚ùå NO | ‚ùå NO | **Para el Setup.** Corre todo en secreto, sin mensajes ni advertencias. |
| **`#| code-fold: true`** | ‚úÖ S√ç | üìÇ Plegado | ‚úÖ S√ç | **Para el Proceso.** El c√≥digo se oculta tras un bot√≥n "Code". |
| **`#| eval: false`** | ‚ùå NO | ‚úÖ S√ç | ‚ùå NO | **Para Tutoriales.** Solo muestra el texto del c√≥digo sin procesarlo. |
| **`#| output: false`** | ‚úÖ S√ç | ‚úÖ S√ç | ‚ùå NO | **Para Debugging.** Ves su c√≥digo pero no los resultados pesados. |
| **`#| warning: false`** | ‚úÖ S√ç | - | - | Oculta esos textos naranjas de advertencia de las librer√≠as. |
| **`#| message: false`** | ‚úÖ S√ç | - | - | Oculta mensajes de carga (ej: "Loading terra package..."). |



---

#### Recomendaciones de Uso seg√∫n el Contexto

Dependiendo de la parte del script en la que se encuentre, existen configuraciones que garantizan un documento m√°s limpio y fluido:

| Tipo de Chunk | Opci√≥n recomendada | ¬øPor qu√©? |
|:--- |:--- |:--- |
| **Setup / Librer√≠as** | `#| include: false` | Ejecuta todo pero oculta el c√≥digo y los mensajes de carga de R/Julia/Python. |
| **Limpieza de RAM** | `#| include: false` | Borra objetos y vac√≠a el cache en silencio. El lector no necesita ver la "limpieza". |
| **Procesamiento** | `#| code-fold: true` | Muestra el mapa pero esconde el c√≥digo tras un clic. Ideal para transparencia acad√©mica. |
| **Resultados Finales** | `#| echo: false` | Muestra solo la tabla comparativa y conclusiones. Es el "veredicto" limpio y profesional. |

::: {.callout-tip}
### Sintaxis Correcta
Recuerde que las opciones deben ir al inicio del chunk, justo despu√©s de los corchetes del lenguaje:
```r
#| echo: false
#| warning: false
library(terra)
# Su c√≥digo aqu√≠...
```
:::

## Docker: Gesti√≥n de Contenedores e Im√°genes {#docker-ref}

### Procedimiento Incial

Antes de trabajar con Docker debes:

1. Arrancar Docker Desktop

2. Usando la terminal **PowerShell** de Windows ubicarte sobre la carpeta d√≥nde se encuentran los archivos `Dockerfile` y  `docker-compose.html`

Los siguientes pasos son **compilar** (solo una vez), arrancar las im√°genes y detener las im√°genes:

3. **Compilaci√≥n Limpia (Sin Cache) con Log:**

```bash
docker build --no-cache -t mi_sig_env:v1 . > build_details.log 2>&1
```
4. **Arrancar las im√°genes:**

```bash
docker compose up -d
```

5. **Detener las im√°genes:** (opcional: solo para terminar)

```bash
docker compose down
```

Finalmente trabajar con los contenedores dentro de VSCode:

6. "Ctrl + Shif + P": "Dev Containers: Attach to Running Container..." y seleccionar container `image_sig_unal` (`contenedor_sig_unal`)

### Comandos Docker

Use la siguiente tabla como referencia para gestionar sus contenedores desde la terminal de su sistema anfitri√≥n (Windows/Mac/Linux).

| Acci√≥n | Comando | Prop√≥sito |
| :- | :--- | :--- |
| **Construcci√≥n Inicial** | `docker-compose up --build -d` | Compila el Dockerfile y levanta los servicios (Solo una vez). |
| **Inicio Diario** | `docker-compose up -d` | Inicia los servicios de forma instant√°nea si ya fueron construidos. |
| **Monitoreo de Procesos** | `docker logs -f entorno_unal_sig` | Sigue los logs en vivo (ideal para ver pre-compilaciones). |
| **Ver logs recientes** | `docker logs --tail 20 entorno_unal_sig` | Muestra las √∫ltimas 20 l√≠neas (ideal para buscar el token). |
| **Apagado** | `docker-compose down` | Detiene los servicios y libera recursos del sistema. |
| **Prueba de R (sf)** | `docker exec entorno_unal_sig R -e "library(sf); print('R-Spatial detectado')"` | Confirmar que R reconoce los drivers geoespaciales del sistema. |
| **Prueba de Python** | `docker exec entorno_unal_sig python -c "import shapely; import geopandas; print('Python OK')"` | Confirmar que el stack de Python (GeoPandas/Shapely) est√° instalado. |
| **Prueba de Julia** | `docker exec entorno_unal_sig julia -e "using LibGEOS; println('Julia OK')"` | Confirmar que Julia tiene acceso a los binarios geoespaciales. |

### Compilaci√≥n Avanzada
Para trabajar con entornos SIG, a menudo necesitamos reconstruir im√°genes sin basura previa.

* **Compilaci√≥n Limpia (Sin Cache) con Log:**
    Para asegurar que Docker descargue todas las librer√≠as desde cero y guarde un registro detallado de los errores:
    `docker build --no-cache -t mi_sig_env:v1 . --progress=plain > build_details.log 2>&1`
* **Subir Imagen a Repositorio:**
    `docker tag mi_sig_env:v1 usuario_dockerhub/mi_sig_env:v1`
    `docker push usuario_dockerhub/mi_sig_env:v1`
* **Cargar en VSCode:**
    Una vez el contenedor est√© corriendo, use la extensi√≥n **Dev Containers** -> Bot√≥n verde inferior izquierdo -> *Attach to Running Container*.

### Cambio de Ruta de Almacenamiento (Windows)
Si el disco `C:` se agota debido a las im√°genes de Docker, siga estos pasos en **Docker Desktop**:
1.  Vaya a **Settings** (engranaje).
2.  **Resources** > **Advanced**.
3.  En **Disk image location**, cambie la ruta a un disco con mayor capacidad (ej. `D:\DockerImages`).
4.  Presione **Apply & Restart**.


### Optimizaci√≥n de Memoria y Swap {#sec-optimizacion-memoria}

Cuando procesamos datos masivos (como im√°genes Sentinel-2 o r√°sters globales), la RAM f√≠sica de 16GB suele ser insuficiente. Para evitar que el sistema aborte los procesos con el error **"Killed"**, debemos configurar un "pulm√≥n" de emergencia en dos niveles.

#### 1. El "Pulm√≥n" de Windows: Memoria Virtual
Obligamos a Windows a usar el disco duro como si fuera RAM de reserva. Si tiene un disco s√≥lido (SSD) secundario con mucho espacio libre (ej. Disco D:), es el lugar ideal para configurarlo.

1.  En el buscador de Windows, escriba: **"Ajustar la apariencia y rendimiento de Windows"**.
2.  Vaya a la pesta√±a **Opciones avanzadas** > secci√≥n **Memoria virtual** > clic en **Cambiar**.
3.  Desmarque la opci√≥n "Administrar autom√°ticamente el tama√±o del archivo de paginaci√≥n para todas las unidades".
4.  Seleccione la unidad de disco (C: o D:) y marque **Tama√±o personalizado**.
5.  Establezca los siguientes valores (recomendados para este curso):
    * **Tama√±o inicial**: `16384` MB (16 GB).
    * **Tama√±o m√°ximo**: `32768` MB (32 GB).
6.  Haga clic en **Establecer**, luego en **Aceptar** y **reinicie su computadora** para aplicar los cambios.

#### 2. El "T√∫nel" de Docker: Swap de WSL2
Docker Desktop corre sobre WSL2 (*Windows Subsystem for Linux*), el cual tiene su propio "presupuesto" limitado. Por defecto, este t√∫nel es estrecho (m√°ximo 4GB de Swap). Si no ampliamos esto, el contenedor nunca podr√° aprovechar realmente el espacio que le asignamos a Windows.

**C√≥mo ampliar la tuber√≠a:**
1.  Presione `Win + R`, escriba `%UserProfile%` y presione Enter.
2.  Busque el archivo `.wslconfig`. Si no existe, cr√©elo con el Bloc de Notas.
3.  Pegue el siguiente contenido:

```ini
[wsl2]
memory=12GB # RAM m√°xima que le permitimos usar a Linux/Docker
swap=16GB   # El nuevo tama√±o de swap que ver√° el comando 'top' en la terminal
```

4.  **Aplicar cambios**: Guarde el archivo, abra una terminal (PowerShell) y escriba `wsl --shutdown`. Luego, inicie Docker Desktop nuevamente.

---

### Higiene y Limpieza de Choque

Para garantizar que un renderizado de Quarto llegue al 100% sin colapsar el contenedor, aplique estas medidas de higiene:

* **Cierre "Vampiros"**: Aplicaciones como Chrome, Edge, Teams y Slack consumen RAM de forma agresiva. Ci√©rrelas antes de procesos pesados.
* **Limpieza de disco**: Use el Liberador de espacio en disco (`cleanmgr`) para vaciar archivos de volcado de memoria.
* **La "Escoba" en el C√≥digo**: Use comandos de limpieza entre procesos de diferentes lenguajes:
    * **R**: `rm(obj); gc(full = TRUE)`
    * **Python**: `del var; gc.collect()`
    * **Julia**: `GC.gc()`



::: {.callout-warning}
### Importante para Visualizaci√≥n
En Julia y R, evite generar gr√°ficos interactivos pesados dentro de bucles de procesamiento. La acumulaci√≥n de objetos visuales en la memoria de VS Code es la causa n√∫mero uno de colapsos en el contenedor.
:::

## Git y GitHub: Sincronizaci√≥n Local-Remota {#git-ref}

### Sub√≠r el contenido existende de una carpeta local a un repositorio vac√≠o en GitHub

Si ya tiene sus archivos en Windows y quiere subirlos a un repositorio reci√©n creado en GitHub:

1. **Instalar Git**

* **Descarga**: Acceda a [git-scm.com/download/win](https://git-scm.com/download/win).
* **Instalaci√≥n**: Ejecute el instalador manteniendo las opciones por defecto; aseg√∫rese de que la opci√≥n **"Git from the command line and also from 3rd-party software"** est√© activa.
* **Verificaci√≥n**: Ejecute `git --version` en una terminal para confirmar la instalaci√≥n.

2. **Crear una cuenta en GitHub**

3.  **Abrir Terminal en la carpeta local:**

4. **Incicializar Git** en la carpeta local:
```powershell
git init
```

5. Ver el **estado actual** del repositorio Git:
```powershell
git status
```

6. **Archivo `.gitignore`**: Crear un archivo de texto `.gitignore` para indicarle a Git que archivos y carperas nunca deben ser registrados con Git. A continuaci√≥n un archivo de ejemplo:

```text
.quarto/
_freeze/
.ipynb_checkpoints/
__pycache__/
*.pdf
*.html
notebooks/
scripts/
data/
```

7. **Registrar (add)** el archivo `.gitignore` con Git:

```powershell
git add .gitignore
```

8. Revise nuevamente el **est√°tus** y verifique cambios:

```powershell
git status
```

9. **Salvar (commit)** el archivo en Git (local). Note que en el comando, el texto "*Archivo .gitignore*" es un comentario que describe lo que est√° salvando:
```powershell
git commit -m "Archivo .gitignore"
```

10. Cambiar al nombre de **rama (branch)** a **principal (main)**. Pueden haber diferentes ramas con diferentes versiones del mismo archivo. Para cambiar a **main**:

```powershell
git branch -M main
```

11. **Conectar** el repositorio local (Git) con nuestro repositorio en GitHub. 

Para conectar Git con GitHub, puede hacerlo con SSH (debe realizar el proceso de instalaci√≥n de llaves @sec-ssh-github) o con HTTPS (debe generar un PAT desde `github.com` que usar√° como clave de autenticaci√≥n). En este caso usaremos HTTPS.

Cree un nuevo repositorio en GitHub y copie la url HTTP del repositorio. Es algo como: `https://github.com/usuario/repositorio.git`


```powershell
git remote add origin https://github.com/usuario/repositorio.git
```

12. Procedimiento para **generar el PAT** en GitHub.com {#github-pat}

- En lugar de escribir tu contrase√±a cuando el terminal te la pida, debes pegar un token generado en tu cuenta.
- Ve a tu cuenta de GitHub.com: `Settings` > `Developer settings` > `Personal access tokens` > `Tokens (classic)`.
- Genera un nuevo token **con el permiso repo activado.**
- Copia el token (no lo volver√°s a ver).


13. **Subir (push)** la informaci√≥n guardada localmente en Git a nuestro repositorio en GitHub:

```powershell
git push -u origin main   
# Cuanto solicite el password use el PAT/token generado previamente en github.com
```

Puedes ver el estatus `git status` y realizar un procedimiento similar para registrar (`add`), salvar (`commit`) y subir (`push`) mas archivos. 

* Registrar archivos espec√≠ficos con Git (local):

```powershell
git add file1 file2 ...
```

* Registrar **todos los archivos y carpetas** disponibles y sin registrar, sin embargo todos los archivos y carpetas dentro de `.gitignore` no ser√°n tenidos en cuenta:

```powershell
git add .
```

* En **resumen** estos son los comandos que usar√°s permanentemente para mentener sincronizados tus archivos con Git y tu Git con GitHub.

- `git add` (agregar archivos a Git)
- `git commit` (guardar archivos en Git)
- `git push` (subir archivos a GitHub)

* Los otros comandos vistos solo se ejecutan **una vez** o de acuerdo con **necesitades espec√≠ficas**:

- `git init` (una vez)
- `git remote add origin` (una vez)
- `git branch -M main` (lo debes usar para cambiar a main en caso de tener m√∫ltiples ramas)


### Autenticaci√≥n Segura: Configuraci√≥n de Llaves SSH en GitHub {#sec-ssh-github}

La autenticaci√≥n mediante SSH permite interactuar con GitHub de forma segura sin necesidad de ingresar credenciales manualmente en cada operaci√≥n. Siga este procedimiento detallado para configurar su acceso.


#### Requitiso Previo: Creaci√≥n de Cuenta en GitHub

El correo que use para crear esta cuenta **debe ser el mismo correo** usado para crear las llaves SSH para conexi√≥n autom√°tica.

#### Requisito Previo: Instalaci√≥n de Git

Es indispensable que su sistema operativo cuente con el motor de Git antes de iniciar la configuraci√≥n:


#### Preparaci√≥n del Entorno Local

* **Navegaci√≥n**: Dir√≠jase mediante el Explorador de Archivos a la carpeta ra√≠z de su proyecto (ejemplo: carpeta `ID Unal`).
* **Terminal**: Abra una ventana de PowerShell en esa ubicaci√≥n (clic derecho -> **"Abrir en Terminal"**).
* **Inicializaci√≥n**: Prepare el repositorio local mediante el comando:

```powershell
git init
```

---

#### Gesti√≥n de Llaves SSH en Windows


**SSH** (*Secure Shell*) es un protocolo de red dise√±ado para el acceso, administraci√≥n y transferencia de datos entre un equipo local y un servidor remoto mediante un canal cifrado. En nuestro flujo de trabajo, implementamos el algoritmo **Ed25519**, un est√°ndar de vanguardia basado en criptograf√≠a de curva el√≠ptica (EdDSA). Este m√©todo no solo ofrece un nivel de seguridad superior frente a ataques de fuerza bruta, sino que permite una **autenticaci√≥n transparente y sin contrase√±a**, actuando como un "pasaporte digital" que vincula de forma √∫nica su estaci√≥n de trabajo con GitHub.

::: {.callout-note}
##### ¬øPor qu√© Ed25519?
A diferencia de los est√°ndares antiguos (como RSA), **Ed25519** genera llaves m√°s cortas, r√°pidas y significativamente m√°s seguras, optimizando la latencia en cada comunicaci√≥n con el repositorio.
:::


* **Comprobaci√≥n de llaves existentes**: Verifique si su usuario ya posee llaves configuradas:

```powershell
ls ~/.ssh
```
    * Si el directorio est√° vac√≠o o solo contiene `known_hosts`, proceda a generar una nueva.
    * Si visualiza los archivos `id_ed25519` e `id_ed25519.pub`, puede saltar al paso de registro en GitHub.

* **Generaci√≥n de llaves**: Cree un par de llaves seguras utilizando el algoritmo Ed25519:

El correo que use en el siguiente paso, **debe** ser el correo con el que cre√≥ la cuenta de GitHub: "su_correo@domimio.com"

```powershell
ssh-keygen -t ed25519 -C "su_correo@domimio.com"
```
    * **Nota**: Presione `ENTER` en todas las solicitudes para aceptar las rutas por defecto y no asignar una *passphrase*.

::: {.callout-note}
### Seguridad de la Identidad
La **llave p√∫blica** (`id_ed25519.pub`) es la que se entrega a GitHub, mientras que la **llave privada** (`id_ed25519`) funciona como su sello personal secreto y nunca debe salir de su equipo.
:::


#### Registro de la Identidad en GitHub

* **Copiar la firma p√∫blica**: Obtenga el contenido de su llave para registrarla:

```powershell
cat $env:USERPROFILE\.ssh\id_ed25519.pub
    ```
    *Seleccione y copie toda la cadena de texto resultante.*

* **Configuraci√≥n en la plataforma**:
    * Acceda a su cuenta en [GitHub.com](https://github.com).
    * Entre a **Settings** -> **SSH and GPG keys**.
    * Seleccione **New SSH key**.
    * Asigne el t√≠tulo `Windows-UNAL-2025`, pegue el contenido en el campo **Key** y presione **Add SSH key**.


#### Activaci√≥n del Agente SSH del Sistema

Para que Windows gestione su identidad de forma transparente, debe habilitar el servicio correspondiente:

* **Modo Administrador**: Cierre su terminal actual y abra una nueva sesi√≥n de **PowerShell como Administrador**.
* **Habilitar Servicio**: Ejecute los siguientes comandos para automatizar el arranque del agente:
```powershell
Set-Service ssh-agent -StartupType Automatic
Start-Service ssh-agent
```

* **Cargar la llave privada**: Registre su llave en el agente activo:
```powershell
ssh-add $env:USERPROFILE\.ssh\id_ed25519
```

#### Verificaci√≥n de la Autenticaci√≥n

* **Prueba de conexi√≥n**: Compruebe que el t√∫nel de comunicaci√≥n con los servidores de GitHub funciona correctamente:
```powershell
ssh -T git@github.com
```
* **Resultado esperado**: Si la configuraci√≥n es exitosa, recibir√° un mensaje similar a: `Hi usuario! You've successfully authenticated, but GitHub does not provide shell access.`

::: {.callout-success}
## ¬°T√∫nel SSH Activo y Configurado!

Has establecido una identidad digital segura entre tu equipo y GitHub. A partir de este momento, la comunicaci√≥n para sincronizar tus repositorios ser√° transparente y autom√°tica.

* **Identidad Permanente**: Esta configuraci√≥n se realiza **una sola vez** por computador; tu "firma digital" ya reside en el sistema.
* **Adi√≥s a las Interrupciones**: GitHub ya no solicitar√° tu usuario, contrase√±a o tokens personales de acceso en cada operaci√≥n.
* **Compatibilidad Total**: Esta llave es reconocida autom√°ticamente por **PowerShell**, **VS Code**, **Positron**, **RStudio** y cualquier otra terminal cient√≠fica que utilices.
* **Seguridad de Grado Profesional**: Tus env√≠os (`push`) viajan ahora por un canal cifrado bajo el est√°ndar Ed25519.


:::


### Vinculaci√≥n del Repositorio de Contenidos de la Clase{#sec-vinculacion-clase}

Los contenidos de la clase est√°n en `https://github.com/alexyshr/ProgramacionSIG2026.git` (HTTPS) o `git@github.com:alexyshr/ProgramacionSIG2026.git` (SSH). La elecci√≥n de uno de estos dos protocolos (HTTPS o SSH), depende de si ha configurado su identidad digital, ver @sec-ssh-github.

::: {.callout-warning}
#### ¬°Advertencia sobre la Estructura de Carpetas!

Es fundamental para el orden del curso que el repositorio con los contenidos de la clase se conecte a una **carpeta independiente**. 

**No sincronice estos archivos dentro de su carpeta local con los contenedores `ID UNAL`**. Mantener directorios separados garantiza que sus ejercicios personales y los materiales de lectura del profesor no se mezclen, evitando errores de sobreescritura y conflictos de Git al realizar actualizaciones del material.
:::


#### Opci√≥n A: Sincronizar mediante SSH (Recomendado)

Utilice este m√©todo si ya configur√≥ sus llaves siguiendo los pasos de la @sec-ssh-github.

* **URL de la Clase**: `git@github.com:alexyshr/ProgramacionSIG2026.git`

* **Vincular el repositorio remoto**:
    Si ya inicializ√≥ su carpeta local (no la de sus contenedores Docker) con `git init`, ejecute el siguiente comando para establecer el origen:
```powershell
git remote add origin git@github.com:alexyshr/ProgramacionSIG2026.git
```

* **Descargar el contenido (Pull)**:
    Para traer los archivos del servidor a su computadora por primera vez:
```powershell
git pull origin main
```

* **Verificaci√≥n de estado**:
    Confirme que la carpeta local est√° sincronizada correctamente:
```powershell
git status
```
    *Resultado esperado: `On branch main. Your branch is up to date. working tree clean.`*

### Opci√≥n B: Sincronizar mediante HTTPS

Utilice este m√©todo si a√∫n no ha configurado llaves SSH o prefiere una descarga r√°pida. A diferencia del m√©todo anterior, este suele solicitar un **Personal Access Token (PAT)** (ver @github-pat) para realizar operaciones de subida (*push*).

* **URL de la Clase**: `https://github.com/alexyshr/ProgramacionSIG2026.git`
* **Instrucci√≥n**: Este comando descarga el repositorio completo y crea autom√°ticamente una subcarpeta con el nombre del proyecto:
```powershell
git clone https://github.com/alexyshr/ProgramacionSIG2026.git
```

### Notas de Flujo de Trabajo

* **Persistencia**: Una vez clonado o vinculado el repositorio, Git recordar√° la ruta del servidor (ya sea SSH o HTTPS). No es necesario repetir los comandos de `remote add` o `clone` en sesiones futuras.
* **Seguridad**: Si opta por HTTPS, recuerde que GitHub ya no acepta contrase√±as b√°sicas por terminal; deber√° generar un Token en la configuraci√≥n de su cuenta. Por esta raz√≥n, se recomienda priorizar el uso de **SSH**.

::: {.callout-tip}
## Siguiente Paso
Con el repositorio sincronizado y el contenedor de Docker activo (como se vio en la @sec-infraestructura), ya puede comenzar a trabajar en sus archivos `.qmd` y ver los cambios reflejados en tiempo real.
:::

## Visual Studio Code: Extensiones e Interfaz {#vscode-ref}

### Atajos de Poder: La Paleta de Comandos {#sec-command-palette}

La mayor√≠a de las funciones avanzadas de VS Code no tienen un bot√≥n visible. Se acceden mediante la **Paleta de Comandos** presionando `Ctrl + Shift + P`. A continuaci√≥n, los comandos m√°s utilizados en este curso:

| Comando (Command Palette) | Prop√≥sito | ¬øCu√°ndo usarlo? |
| :--- | :--- | :--- |
| **`Developer: Reload Window`** | Reinicia la interfaz de VS Code sin cerrar el contenedor. | Cuando una extensi√≥n (como la de R o Julia) deja de responder. |
| **`Dev Containers: Rebuild Container`** | Reconstruye la imagen desde el Dockerfile. | Cuando se realizan cambios en la configuraci√≥n del entorno. |
| **`Quarto: Preview`** | Abre una ventana lateral con la previsualizaci√≥n del documento. | Para ver los cambios en el `.qmd` en tiempo real. |
| **`R: Create R terminal`** | Fuerza la apertura de una nueva consola de R vinculada. | Si el prompt `>` no aparece autom√°ticamente. |
| **`Julia: Start REPL`** | Inicia la consola interactiva de Julia. | Al abrir el contenedor por primera vez para ejecutar c√≥digo Julia. |
| **`Python: Select Interpreter`** | Permite elegir la versi√≥n de Python del contenedor. | Si VS Code no detecta autom√°ticamente `/usr/bin/python3`. |
| **`PostgreSQL: New Query`** | Abre un editor SQL en blanco. | Para realizar consultas a la base de datos espacial. |
| **`Git: Pull` / `Git: Push`** | Sincroniza cambios con GitHub. | Para actualizar el repositorio de la clase o subir tareas. |



---

::: {.callout-important}
### El comando de "Primer Auxilio"
Si notas que el autocompletado desaparece o que los gr√°ficos no cargan en **httpgd**, el primer paso siempre es ejecutar **`Developer: Reload Window`**. Esto refresca todas las conexiones de las extensiones con el contenedor sin interrumpir los procesos que Docker est√° ejecutando de fondo.
:::

#### Atajos de Teclado R√°pidos
Adem√°s de la paleta, memorice estos tres para su flujo diario:
* **`Ctrl + Shift + ` ` `** (acento grave): Abre una nueva Terminal.
* **`Ctrl + Enter`**: Env√≠a la l√≠nea de c√≥digo actual desde el editor al REPL (R, Julia o Python).
* **`Ctrl + Shift + V`**: Previsualiza archivos Markdown (.md) de forma r√°pida.


### Configuraci√≥n de Extensiones en VS Code {#sec-extensiones-vscode}

Para que el entorno de desarrollo sea plenamente funcional, es necesario instalar un conjunto de extensiones espec√≠ficas. Una vez que haya realizado el proceso de **"Attach to Running Container"**, aseg√∫rese de que estas herramientas est√©n instaladas **dentro del contenedor** (busque el bot√≥n azul *Install in Dev Container* en la pesta√±a de extensiones).

| Categor√≠a | Herramienta | Prop√≥sito | ID de la Extensi√≥n |
|:--- |:--- |:--- |:--- |
| **Infraestructura** | **Dev Containers** | Conexi√≥n y gesti√≥n del contenedor activo | `ms-vscode-remote.remote-containers` |
| | **Docker / Container Tools** | Control de im√°genes y recursos del contenedor | `ms-azuretools.vscode-docker` |
| **Ecosistema R** | **R (REditorSupport)** | Soporte de sintaxis, LSP y terminal de R | `REditorSupport.r` |
| | **R Debugger & Tools** | Depuraci√≥n de scripts y herramientas de desarrollo | `RDebugger.r-debugger` |
| | **R Extension Pack** | Pack de utilidades (por Yuki Ueda) | `yukiueda.r-extension-pack` |
| **Ecosistema Python** | **Python (Microsoft)** | IntelliSense (Pylance) y depuraci√≥n avanzada | `ms-python.python` |
| | **Python Debugger** | Motor de depuraci√≥n espec√≠fico para Python | `ms-python.debugpy` |
| | **Jupyter (Microsoft)** | Soporte para Notebooks e interactividad nativa | `ms-toolsai.jupyter` |
| **Ecosistema Julia** | **Julia** | Soporte integral para ejecuci√≥n y gr√°ficos | `julialang.language-julia` |
| **Base de Datos** | **PostgreSQL** | Cliente para explorar la DB (Chris Kolkman) | `ckolkman.vscode-postgres` |
| | **psql** | Herramienta de consulta SQL (doublefint) | `doublefint.psql` |
| **Publicaci√≥n** | **Quarto** | Renderizado y preview de archivos `.qmd` | `quarto.quarto` |
| **Versi√≥n** | **GitHub Repositories** | Manejo de archivos remotos sin clonar todo | `github.remotehub` |

: Extensiones de VS Code para el entorno de Geom√°tica y Programaci√≥n SIG {#tbl-extensiones}

---

#### Notas sobre herramientas espec√≠ficas



* **PostgreSQL (Chris Kolkman)**: Esta extensi√≥n le permitir√° conectarse a la base de datos espacial del contenedor sin salir de VS Code. Podr√° ejecutar queries SQL y visualizar tablas directamente.
* **Jupyter Ecosystem**: Incluimos el *Jupyter Keymap* para aquellos acostumbrados a los atajos de teclado de Jupyter Notebooks. Esto facilita la transici√≥n al trabajar con kernels de Python dentro de Quarto.
* **Sobre `psql`**: La herramienta de l√≠nea de comandos `psql` ya viene preinstalada **dentro del sistema operativo del contenedor** (PostgreSQL Client). No requiere una extensi√≥n adicional para funcionar en la terminal.

::: {.callout-important}
### Instalaci√≥n Local vs. Remota
Recuerde que extensiones como **Dev Containers** y **Docker** deben estar instaladas en su VS Code **local** (en Windows), mientras que las de an√°lisis (R, Python, Julia, PostgreSQL) deben estar instaladas **dentro de la sesi√≥n del contenedor** para acceder a los compiladores y librer√≠as de la imagen.
:::

---

::: {.callout-note}
### Soporte del Lenguaje en R
Para que el autocompletado y la documentaci√≥n en tiempo real funcionen, el contenedor requiere el paquete `languageserver`. Aunque la imagen ya lo incluye por defecto, si nota que el resaltado de sintaxis falla, puede reinstalarlo ejecutando:
`install.packages("languageserver")` en su consola de R.
:::



---

### Verificaci√≥n de Conectividad

Una vez instaladas las extensiones, verifique que su entorno est√© correctamente configurado siguiendo estos puntos:

* **Estado del Contenedor**: En la esquina inferior izquierda de VS Code, debe aparecer un recuadro azul con el texto: **Dev Container: contenedor_sig_unal**.
* **Activaci√≥n de Kernels**: Al abrir un archivo `.qmd`, en la esquina superior derecha debe poder seleccionar el kernel deseado (R, Python 3 o Julia).
* **Terminal Unificada**: Al abrir una nueva terminal (`Ctrl + Shift + ` ` `), la l√≠nea de comandos debe estar identificada como `rstudio@contenedor_sig_unal:/home/rstudio/work$`.

::: {.callout-tip}
## Sincronizaci√≥n Autom√°tica
Recuerde que cualquier cambio que realice en la configuraci√≥n de estas extensiones mientras est√© conectado al contenedor se guardar√° en su perfil local de VS Code, facilitando las conexiones futuras.
:::

## Comandos R√°pidos y Shortcuts {#shortcuts-ref}

### Jupyter Notebook (Dentro de VSCode)
| Acci√≥n | Atajo (Esc Mode) |
| :--- | :--- |
| Ejecutar Celda | `Ctrl + Enter` |
| Ejecutar y pasar a la siguiente | `Shift + Enter` |
| Convertir a Markdown | `M` |
| Convertir a C√≥digo | `Y` |
| Crear celda arriba / abajo | `A` / `B` |

### Comandos de Windows (PowerShell/CMD)


* **Ver uso de RAM:** `Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10`
* **Ver estado de WSL:** `wsl --list --verbose`
* **Limpiar Cache de DNS:** `ipconfig /flushdns`

## Adicionales Sobre Python

### Versiones Instaladas del Software

Para verificar las versiones instaladas, puede ejecutar `pip3 list` en la terminal. Las versiones instaladas deben coincidir con la siguiente tabla:

| Software | Tipo | Versi√≥n | Comando (desde terminal) | Comando (desde Python) |
|:-|:--|:-|:----|:------|
| `Python` | Lenguaje | 3.12.3 | `python3 --version` | `import sys; sys.version` |
| `pip` | Gestor de paquetes | 24.0 | `pip3 --version` | `import pip; pip.__version__` |
| `numpy` | Paquete | 2.4.1 | `pip3 show numpy` | `import numpy; numpy.__version__` |
| `pandas` | Paquete | 2.3.3 | `pip3 show pandas` | `import pandas; pandas.__version__` |
| `geopandas` | Paquete | 1.1.2 | `pip3 show geopandas` | `import geopandas; geopandas.__version__` |
| `shapely` | Paquete | 2.1.2 | `pip3 show shapely` | `import shapely; shapely.__version__` |
| `pyproj` | Paquete | 3.7.2 | `pip3 show pyproj` | `import pyproj; pyproj.__version__` |
| `fiona` | Paquete | 1.10.1 | `pip3 show fiona` | `import fiona; fiona.__version__` |
| `rasterio` | Paquete | 1.5.0 | `pip3 show rasterio` | `import rasterio; rasterio.__version__` |


## Adicionales Sobre R

### Versiones Instaladas del Software

Versiones que deben quedar instaladas en el sistema R:

| Software | Tipo | Versi√≥n | Comando (desde terminal) | Comando (desde R) |
|:-|:-|:-|:------|:---------|
| `R` | Lenguaje | 4.5.2 | `R --version` | `R.version.string` |
| `GEOS` | Librer√≠a sistema | 3.12.1 | `geos-config --version` | `sf::sf_extSoftVersion()["GEOS"]` |
| `GDAL` | Librer√≠a sistema | 3.8.4 | `gdalinfo --version` | `sf::sf_extSoftVersion()["GDAL"]` |
| `PROJ` | Librer√≠a sistema | 9.4.0 | (no aplica / no disponible) | `sf::sf_extSoftVersion()["PROJ"]` |
| `sf` | Paquete | 1.0.23 | `R -q -e "packageVersion('sf')"` | `packageVersion("sf")` |
| `terra` | Paquete | 1.8.86 | `R -q -e "packageVersion('terra')"` | `packageVersion("terra")` |
| `stars` | Paquete | 0.7.0 | `R -q -e "packageVersion('stars')"` | `packageVersion("stars")` |

### Visualizaci√≥n Interactiva con `httpgd` {#sec-httpgd-config}

Dado que nuestro entorno Docker es "headless" (sin monitor propio), utilizamos **`httpgd`** como un servidor gr√°fico intermedio. Este paquete captura las se√±ales de dibujo de R y las sirve a trav√©s de una URL que VS Code puede renderizar.

#### 1. Inicio del Servidor Gr√°fico
Cada vez que inicie una nueva sesi√≥n de R, debe despertar al servidor manualmente:

```r
# Inicia el motor gr√°fico
httpgd::hgd()

# Verifica el estado y el puerto asignado
httpgd::hgd_details()
```

#### 2. Resoluci√≥n de Conflictos (El "Fix" del Puerto)
En nuestro contenedor, el puerto est√°ndar para gr√°ficos est√° mapeado al **8787**. Si al ejecutar `hgd_details()` nota que el sistema asign√≥ un puerto aleatorio o si el visor aparece en blanco, fuerce la conexi√≥n con la siguiente "receta":

```r
# Forzar host y puerto para compatibilidad con Docker
httpgd::hgd(host = "0.0.0.0", port = 8787, token = FALSE)
```

---

#### 3. Formas de ver sus Gr√°ficos
Una vez el servidor est√° corriendo, tiene dos caminos para visualizar sus mapas:

| M√©todo | Comando / Acci√≥n | Ventaja |
| :--- | :--- | :--- |
| **Visor Interno** | `Ctrl + Shift + P` -> **Open httpgd viewer** | Mantiene todo dentro de una pesta√±a de VS Code. |
| **Navegador Externo** | `httpgd::hgd_browse()` | Ideal si trabaja con dos monitores para ver mapas en pantalla completa. |

::: {.callout-note}
### ¬øPor qu√© `token = FALSE`?
Dentro del entorno seguro del contenedor, desactivamos el *token* para facilitar la conexi√≥n inmediata entre el servidor de R y el visor de VS Code sin que el firewall interno bloquee la petici√≥n por falta de credenciales.
:::

---

#### 4. Verificaci√≥n de Salud
Si despu√©s de iniciar el servidor intenta graficar algo (ej: `plot(1:10)`) y no ve nada, ejecute `httpgd::hgd_details()`. Aseg√∫rese de que:
1.  **URL**: Apunte a `http://0.0.0.0:8787`.
2.  **Status**: Indique que est√° escuchando (*listening*).

### El Entorno Interactivo (REPL) y Motores Gr√°ficos {#sec-repl-concept}

En el desarrollo cient√≠fico, el **REPL** (*Read-Eval-Print Loop*) es la consola interactiva que permite la "programaci√≥n exploratoria". Es el ciclo donde el sistema **lee** su instrucci√≥n, la **eval√∫a** mediante el motor correspondiente, **imprime** el resultado y queda en un **bucle** a la espera del siguiente comando.

En nuestro laboratorio pol√≠glota, la identidad visual del REPL es su br√∫jula para saber en qu√© lenguaje est√° operando:

| Lenguaje | ¬øC√≥mo se ve el REPL? | Caracter√≠sticas en este curso |
| :--- | :--- | :--- |
| **R** | `>` | Consola est√°ndar para procesos geoespaciales con `sf` o `terra`. |
| **Julia** | `julia>` | Entorno de alto rendimiento con modos de ayuda (`?`) y terminal (`;`). |
| **Python** | `>>>` | Consola b√°sica; se recomienda el uso de **IPython** para interactividad. |



La experiencia interactiva y el soporte gr√°fico dentro de **VS Code** dependen de la combinaci√≥n entre el motor de ejecuci√≥n y el dispositivo gr√°fico configurado en el contenedor:

| Lenguaje | Acceso / Contexto | Motor de Ejecuci√≥n | Dispositivo Gr√°fico | Soporte Inline |
| :--- | :--- | :--- | :--- | :---: |
| **R** | Nativo (Est√°tico) | R Extension | VS Code Plots (Pane) | ‚úÖ |
| **R** | Nativo (Interactivo) | R Extension | **httpgd** | ‚úÖ |
| **Julia** | Nativo (REPL) | VSCodeServer | VS Code Plots (Pane) | ‚úÖ |
| **Julia** | Interop (R-Bridge) | `JuliaConnectoR` | **httpgd** (v√≠a R) | ‚úÖ |
| **Python** | Interop (R-Bridge) | `reticulate` | R Device (**httpgd**) | ‚ùå / ‚ö†Ô∏è |
| **Python** | Nativo (Jupyter) | Jupyter kernel | Jupyter Viewer | ‚úÖ |

#### El rol cr√≠tico de `httpgd` en R
Para R, no basta con tener la extensi√≥n instalada. El paquete **`httpgd`** act√∫a como un servidor web interno que captura los gr√°ficos generados en el contenedor y los "proyecta" en VS Code. 

* **¬øPor qu√© lo usamos?** Los dispositivos gr√°ficos tradicionales (como `X11` o `windows()`) no funcionan dentro de un contenedor Docker (*headless*). `httpgd` soluciona esto convirtiendo cada mapa en un elemento interactivo SVG/HTML renderizable.
* **Activaci√≥n**: Siempre debe iniciar su sesi√≥n de R ejecutando `httpgd::hgd()` para abrir este canal de comunicaci√≥n.

---

### Paquetes para Comunicaci√≥n con Julia y Python {#sec-interoperabilidad}

Para que este ecosistema funcione, R act√∫a como el "director de orquesta" utilizando un motor de ejecuci√≥n y una serie de puentes que permiten la comunicaci√≥n fluida de datos entre lenguajes.

| Lenguaje / Funci√≥n | Paquete en R | Motor / Prop√≥sito | Estado |
| :--- | :--- | :--- | :---: |
| **Renderizado** | **`knitr`** | Motor maestro que orquesta la ejecuci√≥n de celdas en el documento | ‚úÖ |
| **Julia** | `JuliaConnectoR` | Comunicaci√≥n funcional estable con el kernel de Julia | ‚úÖ |
| **Python** | `reticulate` | Interoperabilidad de objetos y ejecuci√≥n de Python | ‚úÖ |
| **LSP (Soporte)** | `languageserver` | Autocompletado, IntelliSense y ayuda en tiempo real | ‚úÖ |

#### El Rol de `knitr`
Mientras que los paquetes act√∫an como puentes t√©cnicos, **`knitr`** es el encargado de leer el archivo `.qmd`, enviar las instrucciones a los motores respectivos y capturar los resultados (tablas, mapas, gr√°ficos) para integrarlos en el documento final. Sin `knitr`, la integraci√≥n pol√≠glota de Quarto no ser√≠a posible.



#### Transici√≥n T√©cnica: De `JuliaCall` a `JuliaConnectoR`
En el dise√±o de este entorno, se tom√≥ la decisi√≥n t√©cnica de descartar el paquete `JuliaCall` en favor de **`JuliaConnectoR`**:

1. **El Problema**: `JuliaCall` presentaba inestabilidades al gestionar dependencias din√°micas compartidas (como `libcurl` o `libstdc++`) dentro del contenedor, causando cierres inesperados (*crashes*) de la sesi√≥n de R.
2. **La Sustituci√≥n**: Se seleccion√≥ **`JuliaConnectoR`** por su arquitectura m√°s limpia, que no interfiere con el entorno de Julia ya configurado en el sistema operativo.
3. **La Soluci√≥n**: La integraci√≥n se resolvi√≥ mediante una "inyecci√≥n" de c√≥digo en el archivo `Rprofile.site`, configurando autom√°ticamente la ruta del ejecutable en `$Sys.BINDIR$` y definiendo las funciones maestras **`j_eval()`** y **`j_plot()`**.



---

::: {.callout-tip}
### üß† Regla de Oro del Curso
1.  **Julia y R**: Se operan de manera totalmente **interactiva** en VS Code (env√≠o de l√≠neas con `Ctrl+Enter`).
2.  **Python v√≠a reticulate**: Se utiliza primordialmente para el **renderizado (v√≠a knitr)** de informes finales. Para una programaci√≥n interactiva pura en Python, se recomienda el uso de los **Jupyter kernels**.
:::

## Adicionales Sobre Julia

### Versiones Instaladas del Software

Versiones de paquetes `Julia` en el sistema:

| Software | Tipo | Versi√≥n | Comando (desde terminal) | Comando (desde Julia) |
|:-|:-|:-|:-------|:-----|
| `Julia` | Lenguaje | 1.10.4 | `julia --version` | `VERSION` |
| `LibPQ` | Paquete | 1.18.0 | `julia -e "using LibPQ; println(pkgversion(LibPQ))"` | `using LibPQ; pkgversion(LibPQ)` |
| `ArchGDAL` | Paquete | 0.10.11 | `julia -e "using ArchGDAL; println(pkgversion(ArchGDAL))"` | `using ArchGDAL; pkgversion(ArchGDAL)` |
| `LibGEOS` | Paquete | 0.9.7 | `julia -e "using LibGEOS; println(pkgversion(LibGEOS))"` | `using LibGEOS; pkgversion(LibGEOS)` |
| `Plots` | Paquete | 1.41.4 | `julia -e "using Plots; println(pkgversion(Plots))"` | `using Plots; pkgversion(Plots)` |
| `DataFrames` | Paquete | 1.8.1 | `julia -e "using DataFrames; println(pkgversion(DataFrames))"` | `using DataFrames; pkgversion(DataFrames)` |



## Comandos de Terminal (Sistema Operativo) {#sec-comandos-so}

Al trabajar dentro de un contenedor Docker, la terminal es su l√≠nea directa con el sistema operativo (Ubuntu/Debian). Estos comandos le permitir√°n verificar que los motores geoespaciales y las librer√≠as de sistema est√°n correctamente instalados.

| Comando | Prop√≥sito | ¬øPara qu√© sirve en el curso? |
| :--- | :--- | :--- |
| `dpkg -l \| grep -E "libpng\|libgdal\|libproj\|libgeos"` | Lista librer√≠as instaladas | Verificar que los drivers de mapas (GDAL, PROJ, GEOS) est√°n activos. |
| `gdalinfo --version` | Versi√≥n de GDAL | Confirmar que el motor de traducci√≥n de datos geogr√°ficos funciona. |
| `df -h` | Espacio en disco | Evitar errores de "Disk Full" al descargar im√°genes satelitales pesadas. |
| `htop` (o `top`) | Monitor de recursos | Ver si un proceso de Julia o R est√° consumiendo toda la RAM o CPU. |
| `ls -la` | Listado detallado | Revisar permisos de archivos y carpetas (clave para errores de Git). |
| `psql --version` | Versi√≥n de Postgres | Confirmar que el cliente de base de datos est√° listo para usarse. |
| `which r` / `which julia` | Ruta del ejecutable | Localizar d√≥nde est√°n instalados los lenguajes para configurar el Path. |



---

### Verificaci√≥n de Librer√≠as Geoespaciales
El comando `dpkg -l | grep -E "libpng|libgdal|libproj|libgeos"` es su principal herramienta de diagn√≥stico. Si al ejecutarlo no obtiene resultados, las funciones de mapeo en R (`sf`), Python (`geopandas`) y Julia (`ArchGDAL`) fallar√°n, ya que todas dependen de estos binarios del sistema.

::: {.callout-note}
#### Tip de Productividad
En la terminal de VS Code, puede usar la tecla **Tab** para autocompletar nombres de archivos o comandos, y las **flechas arriba/abajo** para navegar por el historial de comandos ejecutados.
:::

#### ¬øC√≥mo leer la salida de `dpkg`?
Al ejecutar el comando de verificaci√≥n, ver√° una lista con el prefijo `ii`. Esto significa:
* **i**: *Desired state* (Install)
* **i**: *Current state* (Installed)

Si ve algo diferente a `ii`, el paquete tiene problemas de instalaci√≥n.

---

## La Cirug√≠a de Librer√≠as: El "Cambiazo" de OpenSSL {#sec-openssl-surgery}

Al trabajar con contenedores de √∫ltima generaci√≥n, a veces nos encontramos con un choque de versiones entre lo que el sistema operativo ofrece y lo que los lenguajes de programaci√≥n esperan. En nuestro caso, realizamos una "cirug√≠a" t√©cnica utilizando enlaces simb√≥licos (`ln -sf`).

### 1. El Conflicto: ¬ø3.0.x o 3.3.x?

La respuesta corta es: **F√≠sicamente tiene instalada la versi√≥n 3.0.x, pero le mentimos al software dici√©ndole que es la 3.3.x.**

* **La Realidad (Sistema)**: Su contenedor corre sobre **Ubuntu 24.04 (Noble Numbat)**. Esta versi√≥n viene de f√°brica con **OpenSSL 3.0.x**, que es la versi√≥n estable y oficial del sistema.
* **La Expectativa (Julia)**: Algunos paquetes potentes de Julia (como los binarios JLL de `GDAL` o `NCDatasets`) fueron compilados en entornos m√°s recientes que ya usaban **OpenSSL 3.3.x**. 

Cuando Julia intenta arrancar, busca una "etiqueta" interna llamada `OPENSSL_3.3.0`. Al no encontrarla en la librer√≠a de Ubuntu, el sistema lanza un error y bloquea la carga de mapas.



### 2. La Soluci√≥n: ¬øQu√© hace exactamente `ln -sf`?

Imagine que Julia es un guardia de seguridad que busca una llave maestra etiquetada como **"Llave 3.3"**. Al revisar la caja fuerte (el sistema), solo ve la **"Llave 3.0"** y se niega a abrir. Lo que hicimos fue un "cambiazo" estrat√©gico.

Ejecutamos este comando de "cirug√≠a":
```bash
find /root/.julia/artifacts -name "libssl.so*" -exec ln -sf /usr/lib/x86_64-linux-gnu/libssl.so.3 {} \;
```

**Desglose de la operaci√≥n:**
1.  **`find ... -name "libssl.so*"`**: Localiza todos los archivos de librer√≠a que Julia descarg√≥ por su cuenta (sus propios binarios internos).
2.  **`-exec ln -sf ... {}`**: Por cada archivo encontrado, borra el original (la `-f` de *force*) y crea un **enlace simb√≥lico** (la `-s` de *symbolic*).
3.  **El Destino**: El enlace apunta directamente a la librer√≠a real de Ubuntu (`/usr/lib/.../libssl.so.3`).

### 3. ¬øPor qu√© funciona si las versiones son distintas?

Funciona gracias a que **OpenSSL 3** mantiene algo llamado **compatibilidad binaria** entre sus versiones menores. Las funciones internas se llaman exactamente igual; lo √∫nico que cambi√≥ fue el "nombre del archivo" que Julia buscaba. 

Al redirigir el nombre, Julia utiliza la librer√≠a de Ubuntu pensando que es la suya, y como las instrucciones internas son compatibles, el sistema arranca sin errores y con total estabilidad.

::: {.callout-warning}
### Importancia para el SIG
Sin esta cirug√≠a, paquetes como `ArchGDAL` en Julia no podr√≠an cargar los controladores para leer archivos `.tif` o conectarse a bases de datos espaciales, ya que la comunicaci√≥n segura (SSL) fallar√≠a al inicio.
:::

---

## Herramientas de admon de Windows

| Acceso Directo | Par√°metro / Comando | Descripci√≥n |
|:--- |:--- |:--- |
| **Windows + R** | `%UserProfile%` | Abre tu carpeta personal de usuario (donde se crea el archivo `.wslconfig`). |
| **Windows + R** | `cleanmgr` | Abre el **Liberador de espacio en disco** para purgar basura del sistema. |
| **Windows + R** | `taskmgr` | **[Ctrl + Shift + Esc]** Abre el **Administrador de Tareas** para ver procesos. |
| **Windows + R** | `resmon` | Abre el **Monitor de Recursos** (ideal para ver el uso real de RAM y Swap). |
| **Windows + R** | `sysdm.cpl` | **[Win + Pausa]** Propiedades del sistema (configuraci√≥n de Memoria Virtual). |
| **Windows + R** | `%temp%` | Abre la carpeta de **Archivos temporales del usuario** actual. |
| **Windows + R** | `temp` | Abre la carpeta de **Archivos temporales del sistema** (ra√≠z). |
| **Windows + R** | `prefetch` | Carpeta de precarga de Windows (cach√© que puedes vaciar para liberar espacio). |
| **Windows + R** | `diskmgmt.msc` | Abre la **Administraci√≥n de discos** (para vigilar tus unidades C: y D:). |
| **Windows + R** | `appdata` | Acceso a carpetas de configuraci√≥n de aplicaciones (Roaming/Local). |
| **Windows + R** | `cmd` | **[Win + X, luego C]** Abre el S√≠mbolo del Sistema (Terminal cl√°sica). |
| **Windows + R** | `powershell` | **[Win + X, luego A]** Abre PowerShell con permisos de administrador. |
| **Windows + R** | `control` | Abre el **Panel de Control cl√°sico** de Windows. |
| **Windows + R** | `msconfig` | Configuraci√≥n del sistema (gesti√≥n de servicios y arranque). |
| **Windows + R** | `ncpa.cpl` | Panel de **Conexiones de red** (configuraci√≥n de adaptadores e IPs). |
| **Nativo** | **Win + E** | Abre instant√°neamente el **Explorador de Archivos**. |
| **Nativo** | **Win + I** | Abre el panel de **Configuraci√≥n de Windows** (Settings). |
| **Nativo** | **Win + D** | **Minimiza/Restaura todo** para ir al Escritorio r√°pidamente. |
| **Nativo** | **Win + V** | Abre el **Historial del Portapapeles** (muy √∫til para copiar varios c√≥digos). |

* Procesos de **WSL2** (Windows Subsystem for Linux 2): Docker y Vmmem
